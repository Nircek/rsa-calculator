<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <link rel="stylesheet" href="style.css" />
    <script src="https://peterolson.github.io/BigInteger.js/BigInteger.min.js"></script>
    <script src="rsa.js"></script>
    <script src="site.js"></script>
  </head>
  <body onload="ginit()">
    <h1>RSA Calculator</h1>
    <h2>0. Generate prime numbers</h2>
    bits: <input name="bits" id="bits" value="16" /><br />
    a = <input name="number" id="number" /><br />
    <button id="random">Generate random number</button><br />
    <button id="if_prime">Check if it's prime</button>
    <span id="number_prime" class="hidden">It is a prime number!</span>
    <span id="number_not_prime" class="hidden">It is NOT a prime number!</span
    ><br />
    <button id="gen_prime">Generate random prime</button><br />
    <!-- <button id="gen_next_prime">Generate next random prime</button><br /> -->
    <h2>1. Pick p and q</h2>
    &#8473; &ni; p = <input name="p" id="p" /><br />
    <button id="atop">a &rarr; p</button><br />
    &#8473; &ni; q = <input name="q" id="q" /><br />
    <button id="atoq">a &rarr; q</button><br />
    <h2>2. Calculate n and &phi;(n)</h2>
    n = p &times; q = <input name="n" id="n" /><br />
    <button id="calc_n">Calculate n</button><br />
    &phi;(n) = ( p - 1 ) ( q - 1 ) = <input name="phi" id="phi" /><br />
    <button id="calc_phi">Calculate &phi;(n)</button><br />
    <h2>3. Pick e and d</h2>
    e = <input name="e" id="e" /><br />
    <button id="calc_e">Find nice e</button><br />
    <button id="calc_e_k">Find e with k</button><br />
    k = <input name="k" id="k" /><br />
    <button id="calc_k">Calculate k</button><br /><br />
    <button id="hide_table">Hide/show table</button><br />
    <table id="k_table">
      <thead>
        <th>k</th>
        <th>k &times; &phi;(n) + 1</th>
        <th>k &times; &phi;(n) + 1 mod e</th>
      </thead>
      <tbody>
        <td>0</td>
        <td>1</td>
        <td>1</td>
      </tbody>
    </table>
    <br />
    d = ( k &times; &phi;(n) + 1 ) &div; e = <input name="d" id="d" /><br />
    <button id="calc_d">Calculate d</button><br />
    <h2>4. Send your public key, store and keep secret your private key</h2>
    <button id="gen">Generate</button>
    <h3>Public key</h3>
    <pre id="pub"></pre>
    <h3>Private key</h3>
    <pre id="sec"></pre>
    <h2>5. Encrypt/decrypt your data</h2>
    <h3>Text</h3>
    <br />
    <textarea name="text" id="text" cols="30" rows="10"></textarea><br /><br />
    <button id="ttom">Convert text to number</button><br />
    Encoding: utf-8 <-> number<br />
    <button id="mtot">Convert number to text</button><br /><br />
    <h3>Number</h3>
    <br />
    m = <input name="m" id="m" /><br />
    <br />
    <br />
    <button id="encrypt">Encrypt/verify</button><br />
    <button id="decrypt">Decrypt/sign</button><br /><br />
    <h3>Cipher</h3>
    c = <input name="c" id="c" />
  </body>
</html>
